{"version":3,"file":"validate-is-my-json-valid.js","names":["isMyJsonValid","newRxError","wrappedValidateStorageFactory","wrappedValidateIsMyJsonValidStorage","schema","validator","docData","isValid","errors","document"],"sources":["../../../src/plugins/validate-is-my-json-valid.ts"],"sourcesContent":["/**\n * this plugin validates documents before they can be inserted into the RxCollection.\n * It's using is-my-json-valid as jsonschema-validator\n * @link https://github.com/mafintosh/is-my-json-valid\n */\nimport isMyJsonValid from 'is-my-json-valid';\nimport {\n    newRxError\n} from '../rx-error';\nimport type {\n    RxJsonSchema\n} from '../types';\nimport { wrappedValidateStorageFactory } from '../plugin-helpers';\n\nexport const wrappedValidateIsMyJsonValidStorage = wrappedValidateStorageFactory(\n    (schema: RxJsonSchema<any>) => {\n        const validator = isMyJsonValid(schema as any);\n        return (docData) => {\n            const isValid = validator(docData);\n            if (!isValid) {\n                throw newRxError('VD2', {\n                    errors: validator.errors,\n                    document: docData,\n                    schema\n                });\n            }\n        };\n    },\n    'is-my-json-valid'\n);\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA,OAAOA,aAAP,MAA0B,kBAA1B;AACA,SACIC,UADJ,QAEO,aAFP;AAMA,SAASC,6BAAT,QAA8C,mBAA9C;AAEA,OAAO,IAAMC,mCAAmC,GAAGD,6BAA6B,CAC5E,UAACE,MAAD,EAA+B;EAC3B,IAAMC,SAAS,GAAGL,aAAa,CAACI,MAAD,CAA/B;EACA,OAAO,UAACE,OAAD,EAAa;IAChB,IAAMC,OAAO,GAAGF,SAAS,CAACC,OAAD,CAAzB;;IACA,IAAI,CAACC,OAAL,EAAc;MACV,MAAMN,UAAU,CAAC,KAAD,EAAQ;QACpBO,MAAM,EAAEH,SAAS,CAACG,MADE;QAEpBC,QAAQ,EAAEH,OAFU;QAGpBF,MAAM,EAANA;MAHoB,CAAR,CAAhB;IAKH;EACJ,CATD;AAUH,CAb2E,EAc5E,kBAd4E,CAAzE"}