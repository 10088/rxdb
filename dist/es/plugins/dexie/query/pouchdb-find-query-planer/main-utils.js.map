{"version":3,"file":"main-utils.js","names":["getArguments","fun","len","arguments","length","args","Array","i","ret","call","undefined","flatten","res","subArr","isArray","concat","apply","push","mergeObjects","arr","Object","assign","oneArrayIsSubArrayOfOther","left","right","Math","min","oneArrayIsStrictSubArrayOfOther","oneSetIsSubArrayOfOther","slice","field","leftIdx","indexOf","splice","arrayToObject","max","maxScore","element","score","arrayEquals","arr1","arr2","uniq","obj","keys","map","key","substring"],"sources":["../../../../../../src/plugins/dexie/query/pouchdb-find-query-planer/main-utils.ts"],"sourcesContent":["\nfunction getArguments(fun: any) {\n    return function () {\n        const len = arguments.length;\n        const args = new Array(len);\n        let i = -1;\n        while (++i < len) {\n            args[i] = arguments[i];\n        }\n        const ret = fun.call(undefined, args);\n        return ret;\n    };\n}\n\nexport const flatten = getArguments(function (args: any) {\n    let res: any[] = [];\n    for (let i = 0, len = args.length; i < len; i++) {\n        const subArr: any = args[i] as any;\n        if (Array.isArray(subArr)) {\n            res = res.concat(flatten.apply(null, subArr as any));\n        } else {\n            res.push(subArr);\n        }\n    }\n    return res;\n});\n\nexport function mergeObjects(arr: any[]) {\n    let res = {};\n    for (let i = 0, len = arr.length; i < len; i++) {\n        res = Object.assign(res, arr[i]);\n    }\n    return res;\n}\n\n\n// e.g. ['a'], ['a', 'b'] is true, but ['b'], ['a', 'b'] is false\nexport function oneArrayIsSubArrayOfOther(left: any, right: any) {\n    for (let i = 0, len = Math.min(left.length, right.length); i < len; i++) {\n        if (left[i] !== right[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\n// e.g.['a', 'b', 'c'], ['a', 'b'] is false\nexport function oneArrayIsStrictSubArrayOfOther(left: any, right: any) {\n    if (left.length > right.length) {\n        return false;\n    }\n\n    return oneArrayIsSubArrayOfOther(left, right);\n}\n\n// same as above, but treat the left array as an unordered set\n// e.g. ['b', 'a'], ['a', 'b', 'c'] is true, but ['c'], ['a', 'b', 'c'] is false\nexport function oneSetIsSubArrayOfOther(left: any, right: any) {\n    left = left.slice();\n    for (let i = 0, len = right.length; i < len; i++) {\n        const field = right[i];\n        if (!left.length) {\n            break;\n        }\n        const leftIdx = left.indexOf(field);\n        if (leftIdx === -1) {\n            return false;\n        } else {\n            left.splice(leftIdx, 1);\n        }\n    }\n    return true;\n}\n\nexport function arrayToObject(arr: any[]) {\n    const res: any = {};\n    for (let i = 0, len = arr.length; i < len; i++) {\n        res[arr[i]] = true;\n    }\n    return res;\n}\n\nexport function max(arr: any[], fun: Function) {\n    let max = null;\n    let maxScore = -1;\n    for (let i = 0, len = arr.length; i < len; i++) {\n        const element = arr[i];\n        const score = fun(element);\n        if (score > maxScore) {\n            maxScore = score;\n            max = element;\n        }\n    }\n    return max;\n}\n\nexport function arrayEquals(arr1: any[], arr2: any[]) {\n    if (arr1.length !== arr2.length) {\n        return false;\n    }\n    for (let i = 0, len = arr1.length; i < len; i++) {\n        if (arr1[i] !== arr2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function uniq(arr: any[]) {\n    const obj: any = {};\n    for (let i = 0; i < arr.length; i++) {\n        obj['$' + arr[i]] = true;\n    }\n    return Object.keys(obj).map(function (key) {\n        return key.substring(1);\n    });\n}\n"],"mappings":"AACA,SAASA,YAAT,CAAsBC,GAAtB,EAAgC;EAC5B,OAAO,YAAY;IACf,IAAMC,GAAG,GAAGC,SAAS,CAACC,MAAtB;IACA,IAAMC,IAAI,GAAG,IAAIC,KAAJ,CAAUJ,GAAV,CAAb;IACA,IAAIK,CAAC,GAAG,CAAC,CAAT;;IACA,OAAO,EAAEA,CAAF,GAAML,GAAb,EAAkB;MACdG,IAAI,CAACE,CAAD,CAAJ,GAAUJ,SAAS,CAACI,CAAD,CAAnB;IACH;;IACD,IAAMC,GAAG,GAAGP,GAAG,CAACQ,IAAJ,CAASC,SAAT,EAAoBL,IAApB,CAAZ;IACA,OAAOG,GAAP;EACH,CATD;AAUH;;AAED,OAAO,IAAMG,OAAO,GAAGX,YAAY,CAAC,UAAUK,IAAV,EAAqB;EACrD,IAAIO,GAAU,GAAG,EAAjB;;EACA,KAAK,IAAIL,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGG,IAAI,CAACD,MAA3B,EAAmCG,CAAC,GAAGL,GAAvC,EAA4CK,CAAC,EAA7C,EAAiD;IAC7C,IAAMM,MAAW,GAAGR,IAAI,CAACE,CAAD,CAAxB;;IACA,IAAID,KAAK,CAACQ,OAAN,CAAcD,MAAd,CAAJ,EAA2B;MACvBD,GAAG,GAAGA,GAAG,CAACG,MAAJ,CAAWJ,OAAO,CAACK,KAAR,CAAc,IAAd,EAAoBH,MAApB,CAAX,CAAN;IACH,CAFD,MAEO;MACHD,GAAG,CAACK,IAAJ,CAASJ,MAAT;IACH;EACJ;;EACD,OAAOD,GAAP;AACH,CAXkC,CAA5B;AAaP,OAAO,SAASM,YAAT,CAAsBC,GAAtB,EAAkC;EACrC,IAAIP,GAAG,GAAG,EAAV;;EACA,KAAK,IAAIL,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGiB,GAAG,CAACf,MAA1B,EAAkCG,CAAC,GAAGL,GAAtC,EAA2CK,CAAC,EAA5C,EAAgD;IAC5CK,GAAG,GAAGQ,MAAM,CAACC,MAAP,CAAcT,GAAd,EAAmBO,GAAG,CAACZ,CAAD,CAAtB,CAAN;EACH;;EACD,OAAOK,GAAP;AACH,C,CAGD;;AACA,OAAO,SAASU,yBAAT,CAAmCC,IAAnC,EAA8CC,KAA9C,EAA0D;EAC7D,KAAK,IAAIjB,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGuB,IAAI,CAACC,GAAL,CAASH,IAAI,CAACnB,MAAd,EAAsBoB,KAAK,CAACpB,MAA5B,CAAtB,EAA2DG,CAAC,GAAGL,GAA/D,EAAoEK,CAAC,EAArE,EAAyE;IACrE,IAAIgB,IAAI,CAAChB,CAAD,CAAJ,KAAYiB,KAAK,CAACjB,CAAD,CAArB,EAA0B;MACtB,OAAO,KAAP;IACH;EACJ;;EACD,OAAO,IAAP;AACH,C,CAED;;AACA,OAAO,SAASoB,+BAAT,CAAyCJ,IAAzC,EAAoDC,KAApD,EAAgE;EACnE,IAAID,IAAI,CAACnB,MAAL,GAAcoB,KAAK,CAACpB,MAAxB,EAAgC;IAC5B,OAAO,KAAP;EACH;;EAED,OAAOkB,yBAAyB,CAACC,IAAD,EAAOC,KAAP,CAAhC;AACH,C,CAED;AACA;;AACA,OAAO,SAASI,uBAAT,CAAiCL,IAAjC,EAA4CC,KAA5C,EAAwD;EAC3DD,IAAI,GAAGA,IAAI,CAACM,KAAL,EAAP;;EACA,KAAK,IAAItB,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGsB,KAAK,CAACpB,MAA5B,EAAoCG,CAAC,GAAGL,GAAxC,EAA6CK,CAAC,EAA9C,EAAkD;IAC9C,IAAMuB,KAAK,GAAGN,KAAK,CAACjB,CAAD,CAAnB;;IACA,IAAI,CAACgB,IAAI,CAACnB,MAAV,EAAkB;MACd;IACH;;IACD,IAAM2B,OAAO,GAAGR,IAAI,CAACS,OAAL,CAAaF,KAAb,CAAhB;;IACA,IAAIC,OAAO,KAAK,CAAC,CAAjB,EAAoB;MAChB,OAAO,KAAP;IACH,CAFD,MAEO;MACHR,IAAI,CAACU,MAAL,CAAYF,OAAZ,EAAqB,CAArB;IACH;EACJ;;EACD,OAAO,IAAP;AACH;AAED,OAAO,SAASG,aAAT,CAAuBf,GAAvB,EAAmC;EACtC,IAAMP,GAAQ,GAAG,EAAjB;;EACA,KAAK,IAAIL,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGiB,GAAG,CAACf,MAA1B,EAAkCG,CAAC,GAAGL,GAAtC,EAA2CK,CAAC,EAA5C,EAAgD;IAC5CK,GAAG,CAACO,GAAG,CAACZ,CAAD,CAAJ,CAAH,GAAc,IAAd;EACH;;EACD,OAAOK,GAAP;AACH;AAED,OAAO,SAASuB,GAAT,CAAahB,GAAb,EAAyBlB,GAAzB,EAAwC;EAC3C,IAAIkC,GAAG,GAAG,IAAV;EACA,IAAIC,QAAQ,GAAG,CAAC,CAAhB;;EACA,KAAK,IAAI7B,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGiB,GAAG,CAACf,MAA1B,EAAkCG,CAAC,GAAGL,GAAtC,EAA2CK,CAAC,EAA5C,EAAgD;IAC5C,IAAM8B,OAAO,GAAGlB,GAAG,CAACZ,CAAD,CAAnB;IACA,IAAM+B,KAAK,GAAGrC,GAAG,CAACoC,OAAD,CAAjB;;IACA,IAAIC,KAAK,GAAGF,QAAZ,EAAsB;MAClBA,QAAQ,GAAGE,KAAX;MACAH,GAAG,GAAGE,OAAN;IACH;EACJ;;EACD,OAAOF,GAAP;AACH;AAED,OAAO,SAASI,WAAT,CAAqBC,IAArB,EAAkCC,IAAlC,EAA+C;EAClD,IAAID,IAAI,CAACpC,MAAL,KAAgBqC,IAAI,CAACrC,MAAzB,EAAiC;IAC7B,OAAO,KAAP;EACH;;EACD,KAAK,IAAIG,CAAC,GAAG,CAAR,EAAWL,GAAG,GAAGsC,IAAI,CAACpC,MAA3B,EAAmCG,CAAC,GAAGL,GAAvC,EAA4CK,CAAC,EAA7C,EAAiD;IAC7C,IAAIiC,IAAI,CAACjC,CAAD,CAAJ,KAAYkC,IAAI,CAAClC,CAAD,CAApB,EAAyB;MACrB,OAAO,KAAP;IACH;EACJ;;EACD,OAAO,IAAP;AACH;AAED,OAAO,SAASmC,IAAT,CAAcvB,GAAd,EAA0B;EAC7B,IAAMwB,GAAQ,GAAG,EAAjB;;EACA,KAAK,IAAIpC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGY,GAAG,CAACf,MAAxB,EAAgCG,CAAC,EAAjC,EAAqC;IACjCoC,GAAG,CAAC,MAAMxB,GAAG,CAACZ,CAAD,CAAV,CAAH,GAAoB,IAApB;EACH;;EACD,OAAOa,MAAM,CAACwB,IAAP,CAAYD,GAAZ,EAAiBE,GAAjB,CAAqB,UAAUC,GAAV,EAAe;IACvC,OAAOA,GAAG,CAACC,SAAJ,CAAc,CAAd,CAAP;EACH,CAFM,CAAP;AAGH"}