{"version":3,"sources":["../../../../../../src/plugins/dexie/query/pouchdb-find-query-planer/main-utils.ts"],"names":["getArguments","fun","len","arguments","length","args","Array","i","ret","call","undefined","flatten","res","subArr","isArray","concat","apply","push","mergeObjects","arr","Object","assign","oneArrayIsSubArrayOfOther","left","right","Math","min","oneArrayIsStrictSubArrayOfOther","oneSetIsSubArrayOfOther","slice","field","leftIdx","indexOf","splice","arrayToObject","max","maxScore","element","score","arrayEquals","arr1","arr2","uniq","obj","keys","map","key","substring"],"mappings":"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","sourcesContent":["\nfunction getArguments(fun: any) {\n    return function () {\n        const len = arguments.length;\n        const args = new Array(len);\n        let i = -1;\n        while (++i < len) {\n            args[i] = arguments[i];\n        }\n        const ret = fun.call(undefined, args);\n        return ret;\n    };\n}\n\nexport const flatten = getArguments(function (args: any) {\n    let res: any[] = [];\n    for (let i = 0, len = args.length; i < len; i++) {\n        const subArr: any = args[i] as any;\n        if (Array.isArray(subArr)) {\n            res = res.concat(flatten.apply(null, subArr as any));\n        } else {\n            res.push(subArr);\n        }\n    }\n    return res;\n});\n\nexport function mergeObjects(arr: any[]) {\n    let res = {};\n    for (let i = 0, len = arr.length; i < len; i++) {\n        res = Object.assign(res, arr[i]);\n    }\n    return res;\n}\n\n\n// e.g. ['a'], ['a', 'b'] is true, but ['b'], ['a', 'b'] is false\nexport function oneArrayIsSubArrayOfOther(left: any, right: any) {\n    for (let i = 0, len = Math.min(left.length, right.length); i < len; i++) {\n        if (left[i] !== right[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\n// e.g.['a', 'b', 'c'], ['a', 'b'] is false\nexport function oneArrayIsStrictSubArrayOfOther(left: any, right: any) {\n    if (left.length > right.length) {\n        return false;\n    }\n\n    return oneArrayIsSubArrayOfOther(left, right);\n}\n\n// same as above, but treat the left array as an unordered set\n// e.g. ['b', 'a'], ['a', 'b', 'c'] is true, but ['c'], ['a', 'b', 'c'] is false\nexport function oneSetIsSubArrayOfOther(left: any, right: any) {\n    left = left.slice();\n    for (let i = 0, len = right.length; i < len; i++) {\n        const field = right[i];\n        if (!left.length) {\n            break;\n        }\n        const leftIdx = left.indexOf(field);\n        if (leftIdx === -1) {\n            return false;\n        } else {\n            left.splice(leftIdx, 1);\n        }\n    }\n    return true;\n}\n\nexport function arrayToObject(arr: any[]) {\n    const res: any = {};\n    for (let i = 0, len = arr.length; i < len; i++) {\n        res[arr[i]] = true;\n    }\n    return res;\n}\n\nexport function max(arr: any[], fun: Function) {\n    let max = null;\n    let maxScore = -1;\n    for (let i = 0, len = arr.length; i < len; i++) {\n        const element = arr[i];\n        const score = fun(element);\n        if (score > maxScore) {\n            maxScore = score;\n            max = element;\n        }\n    }\n    return max;\n}\n\nexport function arrayEquals(arr1: any[], arr2: any[]) {\n    if (arr1.length !== arr2.length) {\n        return false;\n    }\n    for (let i = 0, len = arr1.length; i < len; i++) {\n        if (arr1[i] !== arr2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport function uniq(arr: any[]) {\n    const obj: any = {};\n    for (let i = 0; i < arr.length; i++) {\n        obj['$' + arr[i]] = true;\n    }\n    return Object.keys(obj).map(function (key) {\n        return key.substring(1);\n    });\n}\n"],"file":"main-utils.js"}