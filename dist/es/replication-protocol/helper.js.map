{"version":3,"file":"helper.js","names":["createRevision","flatClone","getDefaultRevision","now","docStateToWriteDoc","hashFunction","docState","previous","docData","Object","assign","_attachments","_meta","lwt","_rev","writeDocToDocState","writeDoc","ret"],"sources":["../../../src/replication-protocol/helper.ts"],"sourcesContent":["import type {\n    HashFunction,\n    RxDocumentData,\n    WithDeleted\n} from '../types';\nimport {\n    createRevision,\n    flatClone,\n    getDefaultRevision,\n    now\n} from '../util';\n\nexport function docStateToWriteDoc<RxDocType>(\n    hashFunction: HashFunction,\n    docState: WithDeleted<RxDocType>,\n    previous?: RxDocumentData<RxDocType>\n): RxDocumentData<RxDocType> {\n    const docData: RxDocumentData<RxDocType> = Object.assign(\n        {},\n        docState,\n        {\n            _attachments: {},\n            _meta: {\n                lwt: now()\n            },\n            _rev: getDefaultRevision()\n        }\n    );\n    docData._rev = createRevision(\n        hashFunction,\n        docData,\n        previous\n    );\n    return docData;\n}\n\nexport function writeDocToDocState<RxDocType>(\n    writeDoc: RxDocumentData<RxDocType>\n): WithDeleted<RxDocType> {\n    const ret = flatClone(writeDoc);\n    delete (ret as any)._attachments;\n    delete (ret as any)._meta;\n    delete (ret as any)._rev;\n    return ret;\n}\n"],"mappings":"AAKA,SACIA,cAAc,EACdC,SAAS,EACTC,kBAAkB,EAClBC,GAAG,QACA,SAAS;AAEhB,OAAO,SAASC,kBAAkB,CAC9BC,YAA0B,EAC1BC,QAAgC,EAChCC,QAAoC,EACX;EACzB,IAAMC,OAAkC,GAAGC,MAAM,CAACC,MAAM,CACpD,CAAC,CAAC,EACFJ,QAAQ,EACR;IACIK,YAAY,EAAE,CAAC,CAAC;IAChBC,KAAK,EAAE;MACHC,GAAG,EAAEV,GAAG;IACZ,CAAC;IACDW,IAAI,EAAEZ,kBAAkB;EAC5B,CAAC,CACJ;EACDM,OAAO,CAACM,IAAI,GAAGd,cAAc,CACzBK,YAAY,EACZG,OAAO,EACPD,QAAQ,CACX;EACD,OAAOC,OAAO;AAClB;AAEA,OAAO,SAASO,kBAAkB,CAC9BC,QAAmC,EACb;EACtB,IAAMC,GAAG,GAAGhB,SAAS,CAACe,QAAQ,CAAC;EAC/B,OAAQC,GAAG,CAASN,YAAY;EAChC,OAAQM,GAAG,CAASL,KAAK;EACzB,OAAQK,GAAG,CAASH,IAAI;EACxB,OAAOG,GAAG;AACd"}