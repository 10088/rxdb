(()=>{"use strict";var e={898:e=>{e.exports=e=>!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.registerSerializer=void 0;const n=r(381);let o=n.DefaultSerializer;t.registerSerializer=function(e){o=n.extendSerializer(o,e)},t.deserialize=function(e){return o.deserialize(e)},t.serialize=function(e){return o.serialize(e)}},381:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultSerializer=t.extendSerializer=void 0,t.extendSerializer=function(e,t){const r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,r),serialize:e=>t.serialize(e,n)}};const r={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};t.DefaultSerializer={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r.deserialize(e):e;var t},serialize:e=>e instanceof Error?r.serialize(e):e}},258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.$worker=t.$transferable=t.$terminate=t.$events=t.$errors=void 0,t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},180:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.isTransferDescriptor=void 0;const n=r(258);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[n.$transferable]},t.Transfer=function(e,t){if(!t){if(!(r=e)||"object"!=typeof r)throw Error();t=[e]}var r;return{[n.$transferable]:!0,send:e,transferables:t}}},229:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,function(e){e.cancel="cancel",e.run="run"}(t.MasterMessageType||(t.MasterMessageType={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(t.WorkerMessageType||(t.WorkerMessageType={}))},447:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={isWorkerRuntime:function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},934:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;const i=o(r(898)),s=r(467),a=r(180),c=r(229),u=o(r(447));var l=r(467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=r(180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),t.isWorkerRuntime=u.default.isWorkerRuntime;let d=!1;const h=new Map,p=e=>e&&e.type===c.MasterMessageType.run,v=e=>i.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function y(e){return a.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){const{payload:r,transferables:n}=y(t),o={type:c.WorkerMessageType.error,uid:e,error:s.serialize(r)};u.default.postMessageToMaster(o,n)}function b(e,t,r){const{payload:n,transferables:o}=y(r),i={type:c.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:n};u.default.postMessageToMaster(i,o)}function g(e){try{const t={type:c.WorkerMessageType.uncaughtError,error:s.serialize(e)};u.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function x(e,t,r){return n(this,void 0,void 0,(function*(){let n;try{n=t(...r)}catch(t){return m(e,t)}const o=v(n)?"observable":"promise";if(function(e,t){const r={type:c.WorkerMessageType.running,uid:e,resultType:t};u.default.postMessageToMaster(r)}(e,o),v(n)){const t=n.subscribe((t=>b(e,!1,s.serialize(t))),(t=>{m(e,s.serialize(t)),h.delete(e)}),(()=>{b(e,!0),h.delete(e)}));h.set(e,t)}else try{const t=yield n;b(e,!0,s.serialize(t))}catch(t){m(e,s.serialize(t))}}))}t.expose=function(e){if(!u.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(d)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(d=!0,"function"==typeof e)u.default.subscribeToMasterMessages((t=>{p(t)&&!t.method&&x(t.uid,e,t.args.map(s.deserialize))})),function(){const e={type:c.WorkerMessageType.init,exposed:{type:"function"}};u.default.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);u.default.subscribeToMasterMessages((t=>{p(t)&&t.method&&x(t.uid,e[t.method],t.args.map(s.deserialize))}));!function(e){const t={type:c.WorkerMessageType.init,exposed:{type:"module",methods:e}};u.default.postMessageToMaster(t)}(Object.keys(e).filter((t=>"function"==typeof e[t])))}u.default.subscribeToMasterMessages((e=>{if((t=e)&&t.type===c.MasterMessageType.cancel){const t=e.uid,r=h.get(t);r&&(r.unsubscribe(),h.delete(t))}var t}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&u.default.isWorkerRuntime()&&(self.addEventListener("error",(e=>{setTimeout((()=>g(e.error||e)),250)})),self.addEventListener("unhandledrejection",(e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout((()=>g(t)),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&u.default.isWorkerRuntime()&&(process.on("uncaughtException",(e=>{setTimeout((()=>g(e)),250)})),process.on("unhandledRejection",(e=>{e&&"string"==typeof e.message&&setTimeout((()=>g(e)),250)})))}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===e(r)?r:String(r)}function n(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,t(o.key),o)}}function o(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t,r){return u=c()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&i(o,r.prototype),o},u.apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return u(e,arguments,a(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),i(n,e)},l(e)}var f={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "};function d(e,t,r){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var r="[object Object]";try{r=JSON.stringify(e[t],((e,t)=>void 0===t?null:t),2)}catch(e){}return t+":"+r})).join("\n"),t+="}")}(r)}var h=function(e){function t(t,r,n={}){var o,i=d(r,t,n);return(o=e.call(this,i)||this).code=t,o.message=i,o.parameters=n,o.rxdb=!0,o}return s(t,e),t.prototype.toString=function(){return this.message},o(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),t}(l(Error));TypeError;function p(e,t){return new h(e,f.tunnelErrorMessage(e),t)}function v(e){if(!e)throw new Error("ensureNotFalsy() is falsy");return e}function y(e,t){var r=e.get(t);if(void 0===r)throw new Error("missing value from map "+t);return r}function m(e=10){for(var t="",r="abcdefghijklmnopqrstuvwxyz",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}var b=0;function g(){var e=(new Date).getTime();(e+=.01)<=b&&(e=b+.01);var t=parseFloat(e.toFixed(2));return b=t,t}function x(e){return function(e,t){var r,n,o,i=0;if("undefined"==typeof TextEncoder||t){o=[];for(var s=0;s<e.length;s++)o.push(e.charCodeAt(s))}else o=(new TextEncoder).encode(e);for(r=0,n=e.length;r<n;r++)i=(i<<5)-i+o[r],i|=0;return i<0&&(i*=-1),i.toString(36)}(e)}function w(e){return Object.assign({},e)}function E(e){return{previous:e.previous,document:O(e.document)}}function O(e){var t=w(e);return t._attachments={},Object.entries(e._attachments).forEach((([e,r])=>{var n,o,i;t._attachments[e]=(i=(n=r).data)?{digest:x(i),length:(o=i,atob(o).length),type:n.type}:n})),t}function S(e,t,r){var n=r.document[t],o=[!!r.previous,r.previous&&r.previous._deleted,!!r.document._deleted].map((e=>e?"1":"0")).join("");return e.databaseName+"|"+e.collectionName+"|"+n+"||"+o+"|"+r.document._rev}var _=function(e,t){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},_(e,t)};function k(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.create;function j(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function I(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;function T(e){return"function"==typeof e}function M(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var P=M((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function A(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var N=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var s=j(i),a=s.next();!a.done;a=s.next()){a.value.remove(this)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(T(c))try{c()}catch(e){o=e instanceof P?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=j(u),f=l.next();!f.done;f=l.next()){var d=f.value;try{C(d)}catch(e){o=null!=o?o:[],e instanceof P?o=I(I([],$(o)),$(e.errors)):o.push(e)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}if(o)throw new P(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)C(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&A(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&A(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),R=N.EMPTY;function D(e){return e instanceof N||e&&"closed"in e&&T(e.remove)&&T(e.add)&&T(e.unsubscribe)}function C(e){T(e)?e():e.unsubscribe()}var z={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},L={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=L.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,I([e,t],$(r))):setTimeout.apply(void 0,I([e,t],$(r)))},clearTimeout:function(e){var t=L.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function F(){}var K=U("C",void 0,void 0);function U(e,t,r){return{kind:e,value:t,error:r}}var W=null;function q(e){if(z.useDeprecatedSynchronousErrorHandling){var t=!W;if(t&&(W={errorThrown:!1,error:null}),e(),t){var r=W,n=r.errorThrown,o=r.error;if(W=null,n)throw o}}else e()}var B=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,D(t)&&t.add(r)):r.destination=X,r}return k(t,e),t.create=function(e,t,r){return new G(e,t,r)},t.prototype.next=function(e){this.isStopped?Y(function(e){return U("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?Y(U("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?Y(K,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(N),H=Function.prototype.bind;function V(e,t){return H.call(e,t)}var Q=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){J(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){J(e)}else J(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){J(e)}},e}(),G=function(e){function t(t,r,n){var o,i,s=e.call(this)||this;T(t)||!t?o={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:s&&z.useDeprecatedNextContext?((i=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},o={next:t.next&&V(t.next,i),error:t.error&&V(t.error,i),complete:t.complete&&V(t.complete,i)}):o=t;return s.destination=new Q(o),s}return k(t,e),t}(B);function J(e){var t;z.useDeprecatedSynchronousErrorHandling?(t=e,z.useDeprecatedSynchronousErrorHandling&&W&&(W.errorThrown=!0,W.error=t)):function(e){L.setTimeout((function(){var t=z.onUnhandledError;if(!t)throw e;t(e)}))}(e)}function Y(e,t){var r=z.onStoppedNotification;r&&L.setTimeout((function(){return r(e,t)}))}var X={closed:!0,next:F,error:function(e){throw e},complete:F},Z="function"==typeof Symbol&&Symbol.observable||"@@observable";function ee(e){return e}function te(e){return 0===e.length?ee:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var re=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,o=this,i=(n=e)&&n instanceof B||function(e){return e&&T(e.next)&&T(e.error)&&T(e.complete)}(n)&&D(n)?e:new G(e,t,r);return q((function(){var e=o,t=e.operator,r=e.source;i.add(t?t.call(i,r):r?o._subscribe(i):o._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=ne(t))((function(t,n){var o=new G({next:function(t){try{e(t)}catch(e){n(e),o.unsubscribe()}},error:n,complete:t});r.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[Z]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return te(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=ne(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function ne(e){var t;return null!==(t=null!=e?e:z.Promise)&&void 0!==t?t:Promise}var oe=M((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),ie=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return k(t,e),t.prototype.lift=function(e){var t=new se(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new oe},t.prototype.next=function(e){var t=this;q((function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=j(t.currentObservers),i=o.next();!i.done;i=o.next()){i.value.next(e)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;q((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;q((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,o=r.isStopped,i=r.observers;return n||o?R:(this.currentObservers=null,i.push(e),new N((function(){t.currentObservers=null,A(i,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,o=t.isStopped;r?e.error(n):o&&e.complete()},t.prototype.asObservable=function(){var e=new re;return e.source=this,e},t.create=function(e,t){return new se(e,t)},t}(re),se=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return k(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:R},t}(ie),ae=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},ce=new Set(["__proto__","prototype","constructor"]),ue=new Set("0123456789");function le(e){var t=[],r="",n="start",o=!1;for(var i of e)switch(i){case"\\":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n)throw new Error("Invalid character after an index");o&&(r+=i),n="property",o=!o;break;case".":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n){n="property";break}if(o){o=!1,r+=i;break}if(ce.has(r))return[];t.push(r),r="",n="property";break;case"[":if("index"===n)throw new Error("Invalid character in an index");if("indexEnd"===n){n="index";break}if(o){o=!1,r+=i;break}if("property"===n){if(ce.has(r))return[];t.push(r),r=""}n="index";break;case"]":if("index"===n){t.push(Number.parseInt(r,10)),r="",n="indexEnd";break}if("indexEnd"===n)throw new Error("Invalid character after an index");default:if("index"===n&&!ue.has(i))throw new Error("Invalid character in an index");if("indexEnd"===n)throw new Error("Invalid character after an index");"start"===n&&(n="property"),o&&(o=!1,r+="\\"),r+=i}switch(o&&(r+="\\"),n){case"property":if(ce.has(r))return[];t.push(r);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function fe(e,t){if("number"!=typeof t&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function de(e,t){var r=t,n=function(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!ae(e)||"string"!=typeof t)return void 0===r?e:r;var n=le(t);if(0===n.length)return r;for(var o=0;o<n.length;o++){var i=n[o];if(null==(e=fe(e,i)?o===n.length-1?void 0:null:e[i])){if(o!==n.length-1)return r;break}}return void 0===e?r:e}(e,r=function(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}(r="properties."+(r=r.replace(/\./g,".properties."))));return n}function he(e){return"string"==typeof e?e:e.key}var pe=String.fromCharCode(65535),ve=-1/0;function ye(e,t){var r=he(e.primaryKey),n=t.selector,o=e.indexes?e.indexes.slice(0):[];t.index?o=[t.index]:o.push([r]);var i,s=t.sort.map((e=>Object.keys(e)[0])).join(","),a=!!t.sort.find((e=>"desc"===Object.values(e)[0])),c=-1;return o.forEach((e=>{var r=!0,o=!0,u=e.map((e=>{var t=n[e],i=t?Object.keys(t):[],s={};return t&&i.length?i.forEach((e=>{if(me.has(e)){var r=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t};case"$lte":return{endKey:t};case"$gte":return{startKey:t};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);s=Object.assign(s,r)}})):s={startKey:o?ve:pe,endKey:r?pe:ve,inclusiveStart:!0,inclusiveEnd:!0},void 0===s.startKey&&(s.startKey=ve),void 0===s.endKey&&(s.endKey=pe),void 0===s.inclusiveStart&&(s.inclusiveStart=!0),void 0===s.inclusiveEnd&&(s.inclusiveEnd=!0),o&&!s.inclusiveStart&&(o=!1),r&&!s.inclusiveEnd&&(r=!1),s})),l={index:e,startKeys:u.map((e=>e.startKey)),endKeys:u.map((e=>e.endKey)),inclusiveEnd:r,inclusiveStart:o,sortFieldsSameAsIndexFields:!a&&s===e.join(","),selectorSatisfiedByIndex:xe(e,t.selector)},f=function(e,t,r){var n=0,o=10,i=r.startKeys.findIndex((e=>e===ve));i>0&&(n+=i*o);var s=r.endKeys.findIndex((e=>e===pe));s>0&&(n+=s*o);var a=5;r.sortFieldsSameAsIndexFields&&(n+=a);return n}(0,0,l);(f>0&&f>c||t.index)&&(c=f,i=l)})),i||(i={index:[r],startKeys:[ve],endKeys:[pe],inclusiveEnd:!0,inclusiveStart:!0,sortFieldsSameAsIndexFields:!a&&s===r,selectorSatisfiedByIndex:xe([r],t.selector)}),i}var me=new Set(["$eq","$gt","$gte","$lt","$lte"]),be=new Set(["$eq","$gt","$gte"]),ge=new Set(["$eq","$lt","$lte"]);function xe(e,t){var r,n;return!Object.entries(t).find((([t,r])=>!e.includes(t)||Object.entries(r).find((([e,t])=>!me.has(e)))))&&(!e.find((e=>{var n=t[e];if(!n)return!1;var o=Object.keys(n).find((e=>be.has(e)));return!(!r||!o)||("$eq"!==o&&(r=o),!1)}))&&!e.find((e=>{var r=t[e];if(!r)return!1;var o=Object.keys(r).find((e=>ge.has(e)));return!(!n||!o)||("$eq"!==o&&(n=o),!1)})))}function we(e,t){var r=t.map((t=>{var r=de(e,t);if(!r)throw new Error("not in schema: "+t);var n,o,i,s=r.type;return"number"!==s&&"integer"!==s||(n=Ee(r)),{fieldName:t,schemaPart:r,parsedLengths:n,hasComplexPath:t.includes("."),getValueFn:(o=t,i=o.split("."),1===i.length?e=>e[o]:e=>{for(var t=e,r=0;r<i.length;){if(void 0===(t=t[i[r]]))return t;r++}return t})}}));return function(e){var t="";return r.forEach((r=>{var n=r.schemaPart,o=n.type,i=r.getValueFn(e);if("string"===o)i||(i=""),t+=i.padEnd(n.maxLength," ");else if("boolean"===o){t+=i?"1":"0"}else{var s=v(r.parsedLengths);i||(i=0),t+=Oe(s,i)}})),t}}function Ee(e){var t=Math.floor(e.minimum),r=Math.ceil(e.maximum),n=e.multipleOf,o=(r-t).toString().length,i=n.toString().split("."),s=0;return i.length>1&&(s=i[1].length),{nonDecimals:o,decimals:s,roundedMinimum:t}}function Oe(e,t){var r="";r+=(Math.floor(t)-e.roundedMinimum).toString().padStart(e.nonDecimals,"0");var n=t.toString().split(".");return r+=(n.length>1?n[1]:"0").padEnd(e.decimals,"0")}function Se(e,t,r,n){var o="";return t.forEach(((t,i)=>{var s=de(e,t),a=r[i],c=s.type;switch(c){case"string":var u=v(s.maxLength);o+="string"==typeof a?a.padEnd(u," "):"".padEnd(u," ");break;case"boolean":if(null===a)o+=n?"0":pe;else o+=a?"1":"0";break;case"number":case"integer":var l=Ee(s);if(null===a||a===ve)o+=(n?"0":pe).repeat(l.nonDecimals+l.decimals);else o+=Oe(l,a);break;default:throw new Error("unknown index type "+c)}})),o}var _e=Promise.resolve(!0),ke=(Promise.resolve(!1),Promise.resolve(null),Promise.resolve());function je(e,t,r,n,o){for(var i=o+1;n<=o;){var s=n+o>>>1,a=e[s];(void 0!==r?r(a,t):a-t)>=0?(i=s,o=s-1):n=s+1}return i}function $e(e,t,r,n,o){for(var i=o+1;n<=o;){var s=n+o>>>1,a=e[s];(void 0!==r?r(a,t):a-t)>0?(i=s,o=s-1):n=s+1}return i}function Ie(e,t,r,n,o){for(var i=n-1;n<=o;){var s=n+o>>>1,a=e[s];(void 0!==r?r(a,t):a-t)<=0?(i=s,n=s+1):o=s-1}return i}function Te(e,t,r,n,o){for(;n<=o;){var i=n+o>>>1,s=e[i],a=void 0!==r?r(s,t):s-t;if(0===a)return i;a<=0?n=i+1:o=i-1}return-1}function Me(e,t,r,n,o,i){return"function"==typeof r?i(e,t,r,void 0===n?0:0|n,void 0===o?e.length-1:0|o):i(e,t,void 0,void 0===r?0:0|r,void 0===n?e.length-1:0|n)}function Pe(e,t,r,n,o){return Me(e,t,r,n,o,$e)}function Ae(e,t,r,n,o){return Me(e,t,r,n,o,Te)}function Ne(e,t){return e+"--memory--"+t}function Re(e){if(e.internals.removed)throw new Error("removed")}function De(e,t){return e+"||"+t}var Ce=(e,t)=>e.indexString<t.indexString?-1:1;function ze(e,t,r,n,o){t.documents.set(e,n.document),r.forEach((t=>{var r=t.docsWithIndex,i=t.getIndexableString(n.document),[,s]=function(e,t,r,n){var o,i=n?e:e.slice(0),s=i.length-1,a=0,c=0;if(0===i.length)return i.push(t),[i,0];for(;a<=s;)r(o=i[c=a+(s-a>>1)],t)<=0?a=c+1:s=c-1;return r(o,t)<=0&&c++,i.splice(c,0,t),[i,c]}(r,{id:e,doc:n.document,indexString:i},Ce,!0);if(o){var a=t.getIndexableString(o);if(a===i){var c=r[s-1];if(c&&c.id===e)r.splice(s-1,1);else{if(r[s+1].id!==e)throw p("SNH",{args:{row:n,byIndex:t}});r.splice(s+1,1)}}else{var u=Ae(r,{indexString:a},Fe);r.splice(u,1)}}}))}function Le(e,t,r,n){var o=n[e];r.documents.delete(o),Object.values(r.byIndex).forEach((e=>{var t=e.docsWithIndex,r=Ae(t,{indexString:e.getIndexableString(n)},Fe);t.splice(r,1)}))}function Fe(e,t){return e.indexString<t.indexString?-1:e.indexString===t.indexString?0:1}function Ke(e,t){var r=he(t.primaryKey),n=t.indexes?t.indexes.map((e=>{return t=e,Array.isArray(t)?t.slice(0):[t];var t})):[];n.push([r]),n.push(["_meta.lwt",r]),n.forEach((r=>{r.unshift("_deleted"),e.byIndex[Ue(r)]={index:r,docsWithIndex:[],getIndexableString:we(t,r)}}));var o=["_meta.lwt",r],i=Ue(o);e.byIndex[i]={index:o,docsWithIndex:[],getIndexableString:we(t,o)}}function Ue(e){return e.join(",")}const We=Number.MAX_SAFE_INTEGER,qe=Number.MIN_SAFE_INTEGER,Be=Symbol("missing"),He=e=>{const t=Et(e);let r=0,n=t.length;for(;n;)r=(r<<5)-r^t.charCodeAt(--n);return r>>>0},Ve=new Set(["null","undefined","boolean","number","string","date","regexp"]),Qe={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},Ge=(e,t)=>{e===Be&&(e=void 0),t===Be&&(t=void 0);const r=Qe[et(e).toLowerCase()],n=Qe[et(t).toLowerCase()];return r!==n?r-n:e<t?-1:e>t?1:0},Je=Object.getPrototypeOf({}),Ye=/^\[object ([a-zA-Z0-9]+)\]$/;function Xe(e,t){if(!e)throw new Error(t)}function Ze(e){return e instanceof Array?e.map(Ze):e instanceof Date?new Date(e):it(e)?function(e,t){const r={},n=Object.keys(e);for(let o=0;o<n.length;o++){const i=n[o];r[i]=t(e[i],i)}return r}(e,Ze):e}function et(e){return Ye.exec(Object.prototype.toString.call(e))[1]}function tt(e){return"boolean"==typeof e}function rt(e){return"string"==typeof e}function nt(e){return!isNaN(e)&&"number"==typeof e}const ot=Array.isArray;function it(e){if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===Je||null===t)&&"[object Object]"===Object.prototype.toString.call(e)}function st(e){return e===Object(e)}function at(e){return e instanceof Date}function ct(e){return e instanceof RegExp}function ut(e){return null==e}function lt(e,t){return e.includes(t)}function ft(e,t){return!lt(e,t)}function dt(e){return ut(e)||rt(e)&&!e||e instanceof Array&&0===e.length||it(e)&&0===Object.keys(e).length}function ht(e){return e===Be}function pt(e){return e instanceof Array?e:[e]}function vt(e,t){return!!e&&Object.prototype.hasOwnProperty.call(e,t)}function yt(e,t,r){if(ht(e))return t;if(ht(t))return e;const n=[e,t];if(!n.every(it)&&!n.every(ot))throw Error("mismatched types. must both be array or object");if(r=r||{flatten:!1},ot(e)){const n=e,o=t;if(r.flatten){let e=0,i=0;for(;e<n.length&&i<o.length;)n[e]=yt(n[e++],o[i++],r);for(;i<o.length;)n.push(t[i++])}else jt(n,o)}else Object.keys(t).forEach((n=>{vt(t,n)&&(vt(e,n)?e[n]=yt(e[n],t[n],r):e[n]=t[n])}));return e}function mt(e,t,r){e.key<t?e.right?mt(e.right,t,r):e.right={key:t,indexes:[r]}:e.key>t?e.left?mt(e.left,t,r):e.left={key:t,indexes:[r]}:e.indexes.push(r)}function bt(e,t){return e.key==t?e.indexes:e.key<t?e.right?bt(e.right,t):void 0:e.key>t&&e.left?bt(e.left,t):void 0}function gt(e,t=He){if(e.some((e=>0==e.length)))return[];const r=e.map(((e,t)=>[t,e.length]));r.sort(((e,t)=>e[1]-t[1]));const n=[],o=e[r[0][0]],i={key:Ot(o[0],t),indexes:[0]};for(let e=1;e<o.length;e++){mt(i,Ot(o[e],t),e)}let s=r[0][1];const a=[];for(let c=1;c<r.length;c++){const u=r[c][0],l=e[u];let f=0;for(let e=0;e<l.length;e++){const r=bt(i,Ot(l[e],t));if(!r)continue;const s=r.map((e=>o[e])).findIndex((t=>wt(t,l[e])));-1!=s&&(n.length<c&&n.push({}),n[n.length-1][r[s]]=!0,f=Object.keys(n[n.length-1]).length,0==u&&-1==a.indexOf(r[s])&&a.push(r[s]))}if(0==f)return[];s=Math.min(s,f)}const c={};n.forEach((e=>{Object.keys(e).forEach((e=>{const t=parseFloat(e);c[t]=c[t]||0,c[t]++}))}));const u=a;return 0==u.length&&(u.push(...Object.keys(c).map(parseFloat)),u.sort()),u.filter((t=>c[t]==e.length-1)).map((e=>o[e]))}function xt(e,t){const r=[];return function e(t,n){for(let o=0,i=t.length;o<i;o++)ot(t[o])&&(n>0||n<0)?e(t[o],Math.max(-1,n-1)):r.push(t[o])}(e,t),r}function wt(e,t){const r=[e],n=[t];for(;r.length>0;){if((e=r.pop())===(t=n.pop()))continue;const o=et(e).toLowerCase();if(o!==et(t).toLowerCase()||"function"===o)return!1;if("array"===o){const o=e,i=t;if(o.length!==i.length)return!1;if(o.length===i.length&&0===o.length)continue;jt(r,o),jt(n,i)}else if("object"===o){const o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(let i=0,s=o.length;i<s;i++){const s=o[i];if(!vt(t,s))return!1;r.push(e[s]),n.push(t[s])}}else if(Et(e)!==Et(t))return!1}return 0===r.length}function Et(e){const t=et(e).toLowerCase();switch(t){case"boolean":case"number":case"regexp":return e.toString();case"string":return JSON.stringify(e);case"date":return e.toISOString();case"null":case"undefined":return t;case"array":return"["+e.map(Et).join(",")+"]"}const r="object"===t?"":`${et(e)}`,n=Object.keys(e);return n.sort(),`${r}{`+n.map((t=>`${Et(t)}:${Et(e[t])}`)).join(",")+"}"}function Ot(e,t=He){return ut(e)?null:t(e).toString()}function St(e,t,r=Ge){const n=[],o=[];if(dt(e))return e;for(let r=0;r<e.length;r++){const i=e[r],s=t(i,r);ut(s)?o.push(i):n.push([s,i])}return n.sort(((e,t)=>r(e[0],t[0]))),o.push(...n.map((e=>e[1]))),o}function _t(e,t,r=He){const n={keys:new Array,groups:new Array},o={};for(let i=0;i<e.length;i++){const s=e[i],a=t(s,i),c=Ot(a,r);let u=-1;void 0===o[c]&&(u=n.keys.length,o[c]=u,n.keys.push(a),n.groups.push([])),u=o[c],n.groups[u].push(s)}return n}const kt=5e4;function jt(e,...t){return e instanceof Array?t.reduce(((e,t)=>{let r=Math.ceil(t.length/kt),n=0;for(;r-- >0;)Array.prototype.push.apply(e,t.slice(n,n+kt)),n+=kt;return e}),e):t.filter(st).reduce(((e,t)=>(Object.assign(e,t),e)),e)}function $t(e,t){return st(e)?e[t]:void 0}function It(e,t,r){let n=0;const o=Ve.has(et(e).toLowerCase())?e:function e(t,r){let o=t;for(let t=0;t<r.length;t++){const i=r[t];if(null===/^\d+$/.exec(i)&&o instanceof Array){if(0===t&&n>0)break;n+=1;const i=r.slice(t);o=o.reduce(((t,r)=>{const n=e(r,i);return void 0!==n&&t.push(n),t}),[]);break}if(o=$t(o,i),void 0===o)break}return o}(e,t.split("."));return o instanceof Array&&r?.unwrapArray?function(e,t){if(t<1)return e;for(;t--&&1===e.length;)e=e[0];return e}(o,n):o}function Tt(e,t,r){const n=t.split("."),o=n[0],i=n.slice(1).join("."),s=null!==/^\d+$/.exec(o),a=n.length>1;let c,u;if(e instanceof Array)if(s)c=$t(e,Number(o)),a&&(c=Tt(c,i,r)),c=[c];else{c=[];for(const n of e)u=Tt(n,t,r),r?.preserveMissing?(void 0===u&&(u=Be),c.push(u)):void 0!==u&&c.push(u)}else{if(u=$t(e,o),a&&(u=Tt(u,i,r)),void 0===u)return;c=r?.preserveKeys?{...e}:{},c[o]=u}return c}function Mt(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===Be?e.splice(t,1):Mt(e[t]);else if(it(e))for(const t in e)vt(e,t)&&Mt(e[t])}function Pt(e,t,r,n){if(ut(e))return;const o=t.split("."),i=o[0],s=o.slice(1).join(".");if(1===o.length)r(e,i);else{n?.buildGraph&&ut(e[i])&&(e[i]={});const t=e[i],a=!!(o.length>1&&o[1].match(/^\d+$/));t instanceof Array&&n?.descendArray&&!a?t.forEach((e=>Pt(e,s,r,n))):Pt(t,s,r,n)}}function At(e,t,r){Pt(e,t,((e,t)=>{e[t]=r}),{buildGraph:!0})}function Nt(e,t,r){Pt(e,t,((e,t)=>{if(e instanceof Array){if(/^\d+$/.test(t))e.splice(parseInt(t),1);else if(r&&r.descendArray)for(const r of e)it(r)&&delete r[t]}else it(e)&&delete e[t]}),r)}const Rt=/^\$[a-zA-Z0-9_]+$/;function Dt(e){return Rt.test(e)}function Ct(e){if(Ve.has(et(e).toLowerCase()))return ct(e)?{$regex:e}:{$eq:e};if(st(e)){if(!Object.keys(e).some(Dt))return{$eq:e};if(vt(e,"$regex"))return{$regex:new RegExp(e.$regex,e.$options)}}return e}var zt,Lt;!function(e){e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF"}(zt||(zt={}));class Ft{options;_root;_local;timestamp;constructor(e,t,r,n=Date.now()){this.options=e,this._root=t,this._local=r,this.timestamp=n,this.options=e,this.update(t,r)}static init(e,t,r){return e instanceof Ft?e.update(ut(e.root)?t:e.root,e.local||r):new Ft(e||Kt(),t,r)}update(e,t){return this._root=e,this._local=t,this}get root(){return this._root}get local(){return this._local}get idKey(){return this.options?.idKey}get collation(){return this.options?.collation}get processingMode(){return this.options?.processingMode||zt.CLONE_OFF}get useStrictMode(){return this.options?.useStrictMode}get scriptEnabled(){return this.options?.scriptEnabled}get hashFunction(){return this.options?.hashFunction}get collectionResolver(){return this.options?.collectionResolver}get jsonSchemaValidator(){return this.options?.jsonSchemaValidator}get variables(){return this.options?.variables}}function Kt(e){return Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,processingMode:zt.CLONE_OFF,...e})}!function(e){e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window"}(Lt||(Lt={}));const Ut={[Lt.ACCUMULATOR]:{},[Lt.EXPRESSION]:{},[Lt.PIPELINE]:{},[Lt.PROJECTION]:{},[Lt.QUERY]:{},[Lt.WINDOW]:{}};function Wt(e,t){for(const[r,n]of Object.entries(t)){Xe(n instanceof Function&&Dt(r),`'${r}' is not a valid operator`);const t=qt(e,r);Xe(!t||n===t,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}jt(Ut[e],t)}function qt(e,t){return Ut[e][t]}const Bt={$$ROOT:(e,t,r)=>r.root,$$CURRENT:(e,t,r)=>e,$$REMOVE(e,t,r){},$$NOW:(e,t,r)=>new Date(r.timestamp)},Ht={$$KEEP:(e,t,r)=>e,$$PRUNE(e,t,r){},$$DESCEND(e,t,r){if(!vt(t,"$cond"))return e;let n;for(const[o,i]of Object.entries(e))if(st(i)){if(i instanceof Array){const e=[];for(let n of i)it(n)&&(n=Qt(n,t,r.update(n))),ut(n)||e.push(n);n=e}else n=Qt(i,t,r.update(i));ut(n)?delete e[o]:e[o]=n}return e}};function Vt(e,t,r,n){const o=Ft.init(n,e);if(Dt(r)){const n=qt(Lt.EXPRESSION,r);if(n)return n(e,t,o);const i=qt(Lt.ACCUMULATOR,r);if(i)return e instanceof Array||(e=Vt(e,t,null,o),t=null),Xe(e instanceof Array,`'${r}' target must be an array.`),i(e,t,o.update(null,o.local));throw new Error(`operator '${r}' is not registered`)}if(rt(t)&&t.length>0&&"$"===t[0]){if(vt(Ht,t))return t;let r=o.root;const n=t.split(".");if(vt(Bt,n[0]))r=Bt[n[0]](e,null,o),t=t.slice(n[0].length+1);else if("$$"===n[0].slice(0,2)){r=Object.assign({},o.variables,{this:e},o.local?.variables);const i=n[0].slice(2);Xe(vt(r,i),`Use of undefined variable: ${i}`),t=t.slice(2)}else t=t.slice(1);return""===t?r:It(r,t)}if(t instanceof Array)return t.map((t=>Vt(e,t,null,o)));if(it(t)){const r={};for(const[n,i]of Object.entries(t))if(r[n]=Vt(e,i,n,o),[Lt.EXPRESSION,Lt.ACCUMULATOR].some((e=>vt(Ut[e],n))))return Xe(1===Object.keys(t).length,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),r[n];return r}return t}function Qt(e,t,r){const n=Vt(e,t,null,r);return vt(Ht,n)?Ht[n](e,t,r):n}function Gt(e){return e instanceof Zt?e:new Zt(e)}function Jt(e,t){const r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}const Yt=new Error;var Xt;!function(e){e[e.MAP=0]="MAP",e[e.FILTER=1]="FILTER",e[e.TAKE=2]="TAKE",e[e.DROP=3]="DROP"}(Xt||(Xt={}));class Zt{iteratees=[];yieldedValues=[];getNext;isDone=!1;constructor(e){let t;if(e instanceof Function&&(e={next:e}),(r=e)&&"object"==typeof r&&r?.next instanceof Function){const r=e;t=()=>{const e=r.next();if(e.done)throw Yt;return e.value}}else if(e instanceof Array){const r=e,n=r.length;let o=0;t=()=>{if(o<n)return r[o++];throw Yt}}else if(!(e instanceof Function))throw new Error(`Source is of type '${typeof e}'. Must be Array, Function, or Generator`);var r;this.getNext=function(e,t,r){let n=!1,o=-1,i=0;return function(s){try{e:for(;!n;){let a=e();o++;let c=-1;const u=t.length;let l=!1;for(;++c<u;){const e=t[c];switch(e.action){case Xt.MAP:a=e.func(a,o);break;case Xt.FILTER:if(!e.func(a,o))continue e;break;case Xt.TAKE:--e.count,e.count||(l=!0);break;case Xt.DROP:--e.count,e.count||Jt(t,c);continue e;default:break e}}if(n=l,!s)return{value:a,done:!1};r[i++]=a}}catch(e){if(e!==Yt)throw e}return n=!0,{done:n}}}(t,this.iteratees,this.yieldedValues)}push(e,t){return"function"==typeof t?this.iteratees.push({action:e,func:t}):"number"==typeof t&&this.iteratees.push({action:e,count:t}),this}next(){return this.getNext()}map(e){return this.push(Xt.MAP,e)}filter(e){return this.push(Xt.FILTER,e)}take(e){return e>0?this.push(Xt.TAKE,e):this}drop(e){return e>0?this.push(Xt.DROP,e):this}transform(e){const t=this;let r;return Gt((()=>(r||(r=Gt(e(t.value()))),r.next())))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(e){for(;;){const t=this.next();if(t.done)break;if(!1===e(t.value))return!1}return!0}reduce(e,t){let r=this.next();for(void 0!==t||r.done||(t=r.value,r=this.next());!r.done;)t=e(t,r.value),r=this.next();return t}size(){return this.reduce(((e,t)=>++e),0)}[Symbol.iterator](){return this}}class er{pipeline;options;constructor(e,t){this.pipeline=e,this.options=t,this.options=Kt(t)}stream(e){let t=Gt(e);const r=this.options.processingMode;r!=zt.CLONE_ALL&&r!=zt.CLONE_INPUT||t.map(Ze);const n=[];if(!dt(this.pipeline))for(const e of this.pipeline){const r=Object.keys(e),o=r[0],i=qt(Lt.PIPELINE,o);Xe(1===r.length&&!!i,`invalid aggregation operator ${o}`),n.push(o),t=i(t,e[o],this.options)}return(r==zt.CLONE_OUTPUT||r==zt.CLONE_ALL&&gt([["$group","$unwind"],n]).length)&&t.map(Ze),t}run(e){return this.stream(e).value()}}class tr{source;predicate;projection;options;operators=[];result=null;buffer=[];constructor(e,t,r,n){this.source=e,this.predicate=t,this.projection=r,this.options=n}fetch(){return this.result||(it(this.projection)&&this.operators.push({$project:this.projection}),this.result=Gt(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new er(this.operators,this.options).stream(this.result))),this.result}fetchAll(){const e=Gt([...this.buffer]);return this.buffer=[],function(...e){let t=0;return Gt((()=>{for(;t<e.length;){const r=e[t].next();if(!r.done)return r;t++}return{done:!0}}))}(e,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(e){return this.operators.push({$skip:e}),this}limit(e){return this.operators.push({$limit:e}),this}sort(e){return this.operators.push({$sort:e}),this}collation(e){return this.options={...this.options,collation:e},this}next(){if(this.buffer.length>0)return this.buffer.pop();const e=this.fetch().next();return e.done?void 0:e.value}hasNext(){if(this.buffer.length>0)return!0;const e=this.fetch().next();return!e.done&&(this.buffer.push(e.value),!0)}map(e){return this.all().map(e)}forEach(e){this.all().forEach(e)}[Symbol.iterator](){return this.fetchAll()}}class rr{criteria;options;compiled;constructor(e,t){this.criteria=e,this.options=t,this.options=Kt(t),this.compiled=[],this.compile()}compile(){let e;Xe(it(this.criteria),"query criteria must be an object");for(const[t,r]of Object.entries(this.criteria)){if("$where"===t)e={field:t,expr:r};else if(lt(["$and","$or","$nor","$expr","$jsonSchema"],t))this.processOperator(t,t,r);else{Xe(!Dt(t),`unknown top level operator: ${t}`);for(const[e,n]of Object.entries(Ct(r)))this.processOperator(t,e,n)}it(e)&&this.processOperator(e.field,e.field,e.expr)}}processOperator(e,t,r){const n=qt(Lt.QUERY,t);Xe(!!n,`unknown operator ${t}`);const o=n(e,r,this.options);this.compiled.push(o)}test(e){for(let t=0,r=this.compiled.length;t<r;t++)if(!this.compiled[t](e))return!1;return!0}find(e,t){return new tr(e,(e=>this.test(e)),t||{},this.options)}remove(e){return e.reduce(((e,t)=>(this.test(t)||e.push(t),e)),[])}}function nr(e,t,r){if(dt(t))return e;let n=Object.keys(t),o=!1;ir(t,r);const i=r.idKey;if(lt(n,i)){const e=t[i];0!==e&&!1!==e||(n=n.filter(ft.bind(null,[i])),o=0==n.length)}else n.push(i);const s=Ft.init(r);return e.map((e=>or(e,t,s.update(e),n,o)))}function or(e,t,r,n,o){let i={},s=!1,a=!1;const c=[];o&&c.push(r.idKey);for(const o of n){let n;const u=t[o];if(o!==r.idKey&&lt([0,!1],u)&&(a=!0),o===r.idKey&&dt(u))n=e[o];else if(rt(u))n=Vt(e,u,o,r);else if(lt([1,!0],u));else if(u instanceof Array)n=u.map((t=>{const n=Vt(e,t,null,r);return ut(n)?null:n}));else{if(!it(u)){c.push(o);continue}{const t=u,i=Object.keys(u),a=1==i.length?i[0]:null,c=qt(Lt.PROJECTION,a);if(c)"$slice"===a?pt(t[a]).every(nt)?(n=c(e,t[a],o),s=!0):n=Vt(e,t,o,r):n=c(e,t[a],o,r);else if(Dt(a))n=Vt(e,t[a],a,r);else if(vt(e,o)){ir(t,r);let s=e[o];s instanceof Array?n=s.map((e=>or(e,t,r,i,!1))):(s=it(s)?s:e,n=or(s,t,r,i,!1))}else n=Vt(e,u,null,r)}}const l=Tt(e,o,{preserveMissing:!0});void 0!==l&&yt(i,l,{flatten:!0}),ft([0,1,!1,!0],u)&&(void 0===n?Nt(i,o,{descendArray:!0}):At(i,o,n))}if(Mt(i),(s||a||o)&&(i=jt({},e,i),c.length>0))for(const e of c)Nt(i,e,{descendArray:!0});return i}function ir(e,t){const r=[!1,!1];for(const[n,o]of Object.entries(e)){if(n===t.idKey)return;0===o||!1===o?r[0]=!0:1!==o&&!0!==o||(r[1]=!0),Xe(!(r[0]&&r[1]),"Projection cannot have a mix of inclusion and exclusion.")}}function sr(e,t,r){if(dt(t)||!it(t))return e;let n=Ge;const o=r.collation;return it(o)&&rt(o.locale)&&(n=function(e){const t={sensitivity:ar[e.strength||3],caseFirst:"off"===e.caseFirst?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:"shifted"===e.alternate};!0===(e.caseLevel||!1)&&("base"===t.sensitivity&&(t.sensitivity="case"),"accent"===t.sensitivity&&(t.sensitivity="variant"));const r=new Intl.Collator(e.locale,t);return(e,t)=>{if(!rt(e)||!rt(t))return Ge(e,t);const n=r.compare(e,t);return n<0?-1:n>0?1:0}}(o)),e.transform((e=>{const o=Object.keys(t);for(const i of o.reverse()){const o=_t(e,(e=>It(e,i)),r?.hashFunction),s={},a=St(o.keys,((e,t)=>(s[e]=t,e)),n);-1===t[i]&&a.reverse(),e=[];for(const t of a)jt(e,o.groups[s[t]])}return e}))}const ar={1:"base",2:"accent",3:"variant"};function cr(e){return(t,r,n)=>{const o={unwrapArray:!0},i=Math.max(1,t.split(".").length-1);return s=>{const a=It(s,t,o);return e(a,r,{...n,depth:i})}}}function ur(e,t,r){if(wt(e,t))return!0;if(ut(e)&&ut(t))return!0;if(e instanceof Array){const n=wt.bind(null,t);return e.some(n)||xt(e,r?.depth).some(n)}return!1}function lr(e,t,r){return ut(e)?t.some((e=>null===e)):gt([pt(e),t],r?.hashFunction).length>0}function fr(e){return Dt(e)&&-1===["$and","$or","$nor"].indexOf(e)}function dr(e,t,r){if(ot(e)&&!dt(e)){let n=e=>e,o=t;Object.keys(t).every(fr)&&(o={temp:t},n=e=>({temp:e}));const i=new rr(o,r);for(let t=0,r=e.length;t<r;t++)if(i.test(n(e[t])))return!0}return!1}const hr=e=>null===e,pr=e=>nt(e)&&e>=-2147483648&&e<=2147483647&&-1===e.toString().indexOf("."),vr=e=>nt(e)&&e>=qe&&e<=We&&-1===e.toString().indexOf("."),yr={array:ot,bool:tt,boolean:tt,date:at,decimal:nt,double:nt,int:pr,long:vr,number:nt,null:hr,object:it,regex:ct,regexp:ct,string:rt,undefined:ut,function:e=>{throw new Error("unsupported type key `function`.")},1:nt,2:rt,3:it,4:ot,6:ut,8:tt,9:at,10:hr,11:ct,16:pr,18:vr,19:nt};function mr(e,t,r){const n=yr[t];return!!n&&n(e)}function br(e,t,r){return pt(e).some((e=>et(e)===et(t)&&r(e,t)))}cr((function(e,t,r){if(!(ot(e)&&ot(t)&&e.length&&t.length))return!1;let n=!0;for(const o of t){if(!n)break;n=it(o)&&lt(Object.keys(o),"$elemMatch")?dr(e,o.$elemMatch,r):o instanceof RegExp?e.some((e=>"string"==typeof e&&o.test(e))):e.some((e=>wt(o,e)))}return n}));const gr=cr(dr),xr=cr((function(e,t,r){return e.length===t})),wr=e=>cr(((t,r,n)=>{let o=0;if(r instanceof Array)for(const e of r)o|=1<<e;else o=r;return e(t&o,o)})),Er=(wr(((e,t)=>0==e)),wr(((e,t)=>e==t)),wr(((e,t)=>e<t)),wr(((e,t)=>e>0)),cr(ur)),Or=cr((function(e,t,r){return br(e,t,((e,t)=>e>t))})),Sr=cr((function(e,t,r){return br(e,t,((e,t)=>e>=t))})),_r=cr(lr),kr=cr((function(e,t,r){return br(e,t,((e,t)=>e<t))})),jr=cr((function(e,t,r){return br(e,t,((e,t)=>e<=t))})),$r=cr((function(e,t,r){return!ur(e,t,r)})),Ir=cr((function(e,t,r){return!lr(e,t,r)})),Tr=cr((function(e,t,r){return(!1===t||0===t)&&void 0===e||(!0===t||1===t)&&void 0!==e})),Mr=cr((function(e,t,r){return Array.isArray(t)?t.findIndex((t=>mr(e,t)))>=0:mr(e,t)}));const Pr=cr((function(e,t,r){return pt(e).some((e=>2===t.length&&e%t[0]===t[1]))})),Ar=cr((function(e,t,r){const n=pt(e),o=e=>rt(e)&&!!t.exec(e);return n.some(o)||xt(n,1).some(o)}));function Nr(e,t,r){Xe(ot(t),"Invalid expression: $and expects value to be an Array");const n=new Array;return t.forEach((e=>n.push(new rr(e,r)))),e=>{for(let t=0;t<n.length;t++)if(!n[t].test(e))return!1;return!0}}function Rr(e,t,r){Xe(ot(t),"Invalid expression. $or expects value to be an Array");const n=t.map((e=>new rr(e,r)));return e=>{for(let t=0;t<n.length;t++)if(n[t].test(e))return!0;return!1}}function Dr(e,t,r){Xe(ot(t),"Invalid expression. $nor expects value to be an Array");const n=Rr(0,t,r);return e=>!n(e)}function Cr(e,t,r){const n={};n[e]=Ct(t);const o=new rr(n,r);return e=>!o.test(e)}var zr=!1;function Lr(e){return zr||(Wt(Lt.PIPELINE,{$sort:sr,$project:nr}),Wt(Lt.QUERY,{$and:Nr,$eq:Er,$elemMatch:gr,$exists:Tr,$gt:Or,$gte:Sr,$in:_r,$lt:kr,$lte:jr,$ne:$r,$nin:Ir,$mod:Pr,$nor:Dr,$not:Cr,$or:Rr,$regex:Ar,$size:xr,$type:Mr}),zr=!0),new rr(e)}var Fr={prepareQuery(e,t){if(!t.sort)throw p("SNH",{query:t});return{query:t,queryPlan:ye(e,t)}},getSortComparator:(e,t)=>function(e,t){var r={};if(!t.sort)throw p("SNH",{query:t});return t.sort.forEach((e=>{var t=Object.keys(e)[0],n=Object.values(e)[0];r[t]=function(e){return"asc"===e?1:-1}(n)})),(e,t)=>Lr({}).find([e,t],{}).sort(r).next()===e?-1:1}(0,t.query),getQueryMatcher(e,t){var r=Lr(t.query.selector);return e=>!e._deleted&&!!r.find([e]).next()},checkpointSchema:{type:"object",properties:{id:{type:"string"},lwt:{type:"number"}},required:["id","lwt"],additionalProperties:!1}};var Kr=function(){function e(e,t,r,n,o,i,s){this.closed=!1,this.storage=e,this.databaseName=t,this.collectionName=r,this.schema=n,this.internals=o,this.options=i,this.settings=s,this.primaryPath=he(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=function(e,t){Re(this);var r={success:{},error:{}},n=function(e,t,r,n,o){var i=!!e.schema.attachments,s=[],a=[],c={},u=[],l={id:m(10),events:[],checkpoint:null,context:o},f=[],d=[],h=[],y=g(),b="function"==typeof r.get;return n.forEach((n=>{var o,m=n.document[t],x=b?r.get(m):r[m];if(x){var w=x._rev;if(!n.previous||n.previous&&w!==n.previous._rev){var _={isError:!0,status:409,documentId:m,writeRow:n,documentInDb:x};return void(c[m]=_)}var k=i?E(n):n;n.document._deleted?n.previous&&Object.keys(n.previous._attachments).forEach((e=>{d.push({documentId:m,attachmentId:e})})):(Object.entries(n.document._attachments).find((([e,t])=>((n.previous?n.previous._attachments[e]:void 0)||t.data||(o={documentId:m,documentInDb:x,isError:!0,status:510,writeRow:n,attachmentId:e}),!0))),o||Object.entries(n.document._attachments).forEach((([e,t])=>{var r=n.previous?n.previous._attachments[e]:void 0;if(r){var o=k.document._attachments[e].digest;t.data&&r.digest!==o&&h.push({documentId:m,attachmentId:e,attachmentData:t})}else f.push({documentId:m,attachmentId:e,attachmentData:t})}))),o?c[m]=o:a.push(k);var j=n.document,$=null,I=null,T=null;if(n.previous&&n.previous._deleted&&!j._deleted)T="INSERT",$=i?O(j):j;else if(!n.previous||n.previous._deleted||j._deleted){if(!j._deleted)throw p("SNH",{args:{writeRow:n}});T="DELETE",$=v(n.document),I=n.previous}else T="UPDATE",$=i?O(j):j,I=n.previous;u.push(m),l.events.push({eventId:S(e,t,n),documentId:m,documentData:v($),previousDocumentData:I,operation:T,startTime:y,endTime:g()})}else{var M=!!n.document._deleted;Object.entries(n.document._attachments).forEach((([e,t])=>{t.data?f.push({documentId:m,attachmentId:e,attachmentData:t}):(o={documentId:m,isError:!0,status:510,writeRow:n,attachmentId:e},c[m]=o)})),o||(i?s.push(E(n)):s.push(n)),M||(u.push(m),l.events.push({eventId:S(e,t,n),documentId:m,operation:"INSERT",documentData:i?O(n.document):n.document,previousDocumentData:i&&n.previous?O(n.previous):n.previous,startTime:y,endTime:g()}))}})),{bulkInsertDocs:s,bulkUpdateDocs:a,errors:c,changedDocumentIds:u,eventBulk:l,attachmentsAdd:f,attachmentsRemove:d,attachmentsUpdate:h}}(this,this.primaryPath,this.internals.documents,e,t);r.error=n.errors;var o=Object.values(this.internals.byIndex);n.bulkInsertDocs.forEach((e=>{var t=e.document[this.primaryPath];ze(t,this.internals,o,e,void 0),r.success[t]=e.document})),n.bulkUpdateDocs.forEach((e=>{var t=e.document[this.primaryPath];ze(t,this.internals,o,e,this.internals.documents.get(t)),r.success[t]=e.document}));var i=this.internals.attachments;if(n.attachmentsAdd.forEach((e=>{i.set(De(e.documentId,e.attachmentId),e.attachmentData)})),n.attachmentsUpdate.forEach((e=>{i.set(De(e.documentId,e.attachmentId),e.attachmentData)})),n.attachmentsRemove.forEach((e=>{i.delete(De(e.documentId,e.attachmentId))})),n.eventBulk.events.length>0){var s=function(e,t){var r=null;return t.forEach((t=>{(!r||t._meta.lwt>r._meta.lwt||t._meta.lwt===r._meta.lwt&&t[e]>r[e])&&(r=t)})),v(r)}(this.primaryPath,Object.values(r.success));n.eventBulk.checkpoint={id:s[this.primaryPath],lwt:s._meta.lwt},this.internals.changes$.next(n.eventBulk)}return Promise.resolve(r)},t.findDocumentsById=function(e,t){var r={};return e.forEach((e=>{var n=this.internals.documents.get(e);!n||n._deleted&&!t||(r[e]=n)})),Promise.resolve(r)},t.query=function(e){var t=e.queryPlan,r=e.query,n=r.skip?r.skip:0,o=n+(r.limit?r.limit:1/0),i=!1;t.selectorSatisfiedByIndex||(i=Fr.getQueryMatcher(this.schema,e));var s=t.index,a=!t.sortFieldsSameAsIndexFields,c=["_deleted"].concat(s),u=t.startKeys;u=[!1].concat(u);var l=Se(this.schema,c,u,t.inclusiveStart),f=t.endKeys;f=[!1].concat(f);for(var d,h,p=function(e,t,r,n){var o="";return t.forEach(((t,i)=>{var s=de(e,t),a=r[i],c=s.type;switch(c){case"string":var u=v(s.maxLength);o+="string"==typeof a?a.padEnd(u,n?pe:" "):"".padEnd(u,n?pe:" ");break;case"boolean":o+=null===a?n?"0":"1":a?"1":"0";break;case"number":case"integer":var l=Ee(s);o+=null===a||a===pe?(n?"9":"0").repeat(l.nonDecimals+l.decimals):Oe(l,a);break;default:throw new Error("unknown index type "+c)}})),o}(this.schema,c,f,t.inclusiveEnd),y=Ue(c),m=this.internals.byIndex[y].docsWithIndex,b=Me(m,{indexString:l},Fe,d,h,je),g=function(e,t,r,n,o){return Me(e,t,r,n,o,Ie)}(m,{indexString:p},Fe),x=[],w=!1;!w;){var E=m[b];if(!E||b>g)break;i&&!i(E.doc)||x.push(E.doc),(x.length>=o&&!a||b>=m.length)&&(w=!0),b++}if(a){var O=Fr.getSortComparator(this.schema,e);x=x.sort(O)}return x=x.slice(n,o),Promise.resolve({documents:x})},t.count=async function(e){return{count:(await this.query(e)).documents.length,mode:"fast"}},t.getChangedDocumentsSince=function(e,t){for(var r=t?t.lwt:1,n=t?t.id:"",o=Ue(["_meta.lwt",this.primaryPath]),i=Se(this.schema,["_meta.lwt",this.primaryPath],[r,n],!1),s=this.internals.byIndex[o].docsWithIndex,a=Pe(s,{indexString:i},Fe),c=[];c.length<e&&a<s.length;){var u=s[a];c.push(u.doc),a++}var l,f=(l=c)[l.length-1];return Promise.resolve({documents:c,checkpoint:f?{id:f[this.primaryPath],lwt:f._meta.lwt}:t||{id:"",lwt:0}})},t.cleanup=function(e){for(var t=g()-e,r=["_deleted","_meta.lwt",this.primaryPath],n=Ue(r),o=this.internals.byIndex[n].docsWithIndex,i=Pe(o,{indexString:Se(this.schema,r,[!0,0,""],!1)},Fe),s=!1;!s;){var a=o[i];!a||a.doc._meta.lwt>t?s=!0:(Le(this.primaryPath,this.schema,this.internals,a.doc),i++)}return _e},t.getAttachmentData=function(e,t){Re(this);var r=y(this.internals.attachments,De(e,t));return Promise.resolve(r.data)},t.changeStream=function(){return Re(this),this.internals.changes$.asObservable()},t.remove=async function(){Re(this),this.internals.removed=!0,this.storage.collectionStates.delete(Ne(this.databaseName,this.collectionName)),await this.close()},t.close=function(){return this.closed?Promise.reject(new Error("already closed")):(this.closed=!0,this.internals.refCount=this.internals.refCount-1,ke)},t.conflictResultionTasks=function(){return this.internals.conflictResultionTasks$.asObservable()},t.resolveConflictResultionTask=function(e){return ke},e}();var Ur=new Map;var Wr=r(934);const qr=Wr.expose;Wr.registerSerializer,Wr.Transfer;var Br,Hr,Vr,Qr,Gr=function(e={}){var t={name:"memory",statics:Fr,collectionStates:Ur,createStorageInstance(t){return function(e){if(e.schema.keyCompression)throw p("UT5",{args:{params:e}});if((t=e.schema).encrypted&&t.encrypted.length>0||t.attachments&&t.attachments.encrypted)throw p("UT6",{args:{params:e}});var t}(t),(t=w(t)).collectionName=t.collectionName+"-"+t.schema.version,function(e,t,r){var n=Ne(t.databaseName,t.collectionName),o=e.collectionStates.get(n);o?o.refCount=o.refCount+1:(Ke(o={removed:!1,refCount:1,documents:new Map,attachments:t.schema.attachments?new Map:void 0,byIndex:{},conflictResultionTasks$:new ie,changes$:new ie},t.schema),e.collectionStates.set(n,o));var i=new Kr(e,t.databaseName,t.collectionName,t.schema,o,t.options,r);return Promise.resolve(i)}(this,t,Object.assign({},e,t.options))}};return t}({});Br={storage:Gr},Hr=0,Vr=new Map,Qr={async createStorageInstance(e){var t=Hr++,r=await Br.storage.createStorageInstance(e);return Vr.set(t,r),t},bulkWrite:(e,t,r)=>y(Vr,e).bulkWrite(t,r),findDocumentsById:(e,t,r)=>y(Vr,e).findDocumentsById(t,r),query:(e,t)=>y(Vr,e).query(t),count:(e,t)=>y(Vr,e).count(t),getAttachmentData:(e,t,r)=>y(Vr,e).getAttachmentData(t,r),getChangedDocumentsSince:(e,t,r)=>y(Vr,e).getChangedDocumentsSince(t,r),changeStream:e=>y(Vr,e).changeStream(),cleanup:(e,t)=>y(Vr,e).cleanup(t),close:e=>y(Vr,e).close(),remove:e=>y(Vr,e).remove(),conflictResultionTasks:e=>y(Vr,e).conflictResultionTasks(),resolveConflictResultionTask:(e,t)=>y(Vr,e).resolveConflictResultionTask(t)},qr(Qr)})()})();
//# sourceMappingURL=memory.worker.js.map