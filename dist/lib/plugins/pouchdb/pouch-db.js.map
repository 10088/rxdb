{"version":3,"file":"pouch-db.js","names":["isLevelDown","adapter","super_","newRxError","isInstanceOf","obj","PouchDBCore","ADDED_POUCH_PLUGINS","Set","addPouchPlugin","plugin","rxdb","newRxTypeError","has","add","PouchDB"],"sources":["../../../../src/plugins/pouchdb/pouch-db.ts"],"sourcesContent":["/**\n * this handles the pouchdb-instance\n * to easy add modules and manipulate things\n * Adapters can be found here:\n * @link https://github.com/pouchdb/pouchdb/tree/master/packages/node_modules\n */\nimport PouchDBCore from 'pouchdb-core';\n\n/*\n// comment in to debug\nconst pouchdbDebug = require('pouchdb-debug');\nPouchDB.plugin(pouchdbDebug);\nPouchDB.debug.enable('*');\n*/\n\n\nimport {\n    newRxError,\n    newRxTypeError\n} from '../../rx-error';\n\n\n/**\n * check if the given module is a leveldown-adapter\n * throws if not\n */\nexport function isLevelDown(adapter: any) {\n    if (!adapter || typeof adapter.super_ !== 'function') {\n        throw newRxError('UT4', {\n            adapter\n        });\n    }\n}\n\nexport function isInstanceOf(obj: any) {\n    return obj instanceof PouchDBCore;\n}\n\n/**\n * Adding a PouchDB plugin multiple times,\n * can sometimes error. So we have to check if the plugin\n * was added before.\n */\nconst ADDED_POUCH_PLUGINS: Set<any> = new Set();\n\n/**\n * Add a pouchdb plugin to the pouchdb library.\n */\nexport function addPouchPlugin(plugin: any) {\n    if (plugin.rxdb) {\n        throw newRxTypeError('PL2', {\n            plugin\n        });\n    }\n    /**\n     * Pouchdb has confusing typings and modules.\n     * So we monkeypatch the plugin to use the default property\n     * when it was imported or packaged this way.\n     */\n    if (typeof plugin === 'object' && plugin.default) {\n        plugin = plugin.default;\n    }\n\n    if (!ADDED_POUCH_PLUGINS.has(plugin)) {\n        ADDED_POUCH_PLUGINS.add(plugin);\n        PouchDBCore.plugin(plugin);\n    }\n}\n\n\nexport const PouchDB: any = PouchDBCore as any;\n"],"mappings":";;;;;;;;;;AAMA;AAUA;AAhBA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;;AASA;AACA;AACA;AACA;AACO,SAASA,WAAW,CAACC,OAAY,EAAE;EACtC,IAAI,CAACA,OAAO,IAAI,OAAOA,OAAO,CAACC,MAAM,KAAK,UAAU,EAAE;IAClD,MAAM,IAAAC,mBAAU,EAAC,KAAK,EAAE;MACpBF,OAAO,EAAPA;IACJ,CAAC,CAAC;EACN;AACJ;AAEO,SAASG,YAAY,CAACC,GAAQ,EAAE;EACnC,OAAOA,GAAG,YAAYC,uBAAW;AACrC;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAMC,mBAA6B,GAAG,IAAIC,GAAG,EAAE;;AAE/C;AACA;AACA;AACO,SAASC,cAAc,CAACC,MAAW,EAAE;EACxC,IAAIA,MAAM,CAACC,IAAI,EAAE;IACb,MAAM,IAAAC,uBAAc,EAAC,KAAK,EAAE;MACxBF,MAAM,EAANA;IACJ,CAAC,CAAC;EACN;EACA;AACJ;AACA;AACA;AACA;EACI,IAAI,OAAOA,MAAM,KAAK,QAAQ,IAAIA,MAAM,WAAQ,EAAE;IAC9CA,MAAM,GAAGA,MAAM,WAAQ;EAC3B;EAEA,IAAI,CAACH,mBAAmB,CAACM,GAAG,CAACH,MAAM,CAAC,EAAE;IAClCH,mBAAmB,CAACO,GAAG,CAACJ,MAAM,CAAC;IAC/BJ,uBAAW,CAACI,MAAM,CAACA,MAAM,CAAC;EAC9B;AACJ;AAGO,IAAMK,OAAY,GAAGT,uBAAkB;AAAC"}