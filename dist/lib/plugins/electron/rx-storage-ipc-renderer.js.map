{"version":3,"file":"rx-storage-ipc-renderer.js","names":["getRxStorageIpcRenderer","settings","channelId","IPC_RENDERER_KEY_PREFIX","key","join","messages$","Subject","ipcRenderer","on","_event","message","next","postMessage","send","msg","storage","getRxStorageMessageChannel","name","statics"],"sources":["../../../../src/plugins/electron/rx-storage-ipc-renderer.ts"],"sourcesContent":["import { Subject } from 'rxjs';\nimport {\n    getRxStorageMessageChannel,\n    RxStorageMessageChannel,\n    RxStorageMessageChannelSettings,\n    RxStorageMessageFromRemote\n} from '../../rx-storage-message-channel';\nimport type {\n    RxStorageStatics\n} from '../../types';\nimport {\n    IPC_RENDERER_KEY_PREFIX\n} from './electron-helper';\n\nexport type RxStorageIpcRendererSettings = {\n    /**\n     * Set the same key on both sides\n     * to ensure that messages do not get mixed\n     * up when you use more then one storage.\n     */\n    key: string;\n    statics: RxStorageStatics;\n    ipcRenderer: any;\n};\n\nexport type RxStorageIpcRenderer = RxStorageMessageChannel;\nexport function getRxStorageIpcRenderer(\n    settings: RxStorageIpcRendererSettings\n): RxStorageIpcRenderer {\n    const channelId = [\n        IPC_RENDERER_KEY_PREFIX,\n        settings.key\n    ].join('|');\n\n    const messages$ = new Subject<RxStorageMessageFromRemote>();\n    settings.ipcRenderer.on(channelId, (_event: any, message: any) => {\n        messages$.next(message);\n    });\n\n\n    settings.ipcRenderer.postMessage(\n        channelId,\n        false\n    );\n\n    const send: RxStorageMessageChannelSettings['send'] = (msg) => {\n        settings.ipcRenderer.postMessage(\n            channelId,\n            msg\n        );\n    };\n    const storage = getRxStorageMessageChannel({\n        name: 'ipc-renderer',\n        statics: settings.statics,\n        messages$,\n        send\n    });\n    return storage;\n}\n"],"mappings":";;;;;;AAAA;AACA;AASA;AAgBO,SAASA,uBAAuB,CACnCC,QAAsC,EAClB;EACpB,IAAMC,SAAS,GAAG,CACdC,uCAAuB,EACvBF,QAAQ,CAACG,GAAG,CACf,CAACC,IAAI,CAAC,GAAG,CAAC;EAEX,IAAMC,SAAS,GAAG,IAAIC,aAAO,EAA8B;EAC3DN,QAAQ,CAACO,WAAW,CAACC,EAAE,CAACP,SAAS,EAAE,UAACQ,MAAW,EAAEC,OAAY,EAAK;IAC9DL,SAAS,CAACM,IAAI,CAACD,OAAO,CAAC;EAC3B,CAAC,CAAC;EAGFV,QAAQ,CAACO,WAAW,CAACK,WAAW,CAC5BX,SAAS,EACT,KAAK,CACR;EAED,IAAMY,IAA6C,GAAG,SAAhDA,IAA6C,CAAIC,GAAG,EAAK;IAC3Dd,QAAQ,CAACO,WAAW,CAACK,WAAW,CAC5BX,SAAS,EACTa,GAAG,CACN;EACL,CAAC;EACD,IAAMC,OAAO,GAAG,IAAAC,mDAA0B,EAAC;IACvCC,IAAI,EAAE,cAAc;IACpBC,OAAO,EAAElB,QAAQ,CAACkB,OAAO;IACzBb,SAAS,EAATA,SAAS;IACTQ,IAAI,EAAJA;EACJ,CAAC,CAAC;EACF,OAAOE,OAAO;AAClB"}