{"version":3,"sources":["../../../../src/plugins/replication/revision-flag.ts"],"names":["createRevisionForPulledDocument","replicationIdentifierHash","doc","dataHash","ret","substring","wasRevisionfromPullReplication","revision","useFromHash","endsWith"],"mappings":";;;;;;;;AAQA;;AARA;AACA;AACA;AACA;AACA;AACA;AACA;;AAOA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,+BAAT,CACHC,yBADG,EAEHC,GAFG,EAGL;AACE,MAAMC,QAAQ,GAAG,gBAAKD,GAAL,CAAjB;AAEA,MAAME,GAAG,GACLD,QAAQ,CAACE,SAAT,CAAmB,CAAnB,EAAsB,CAAtB,IACAJ,yBAAyB,CAACI,SAA1B,CAAoC,CAApC,EAAuC,EAAvC,CAFJ;AAGA,SAAOD,GAAP;AACH;;AAEM,SAASE,8BAAT,CACHL,yBADG,EAEHM,QAFG,EAGL;AACE,MAAMC,WAAW,GAAGP,yBAAyB,CAACI,SAA1B,CAAoC,CAApC,EAAuC,EAAvC,CAApB;AAEA,MAAMD,GAAG,GAAGG,QAAQ,CAACE,QAAT,CAAkBD,WAAlB,CAAZ;AACA,SAAOJ,GAAP;AACH","sourcesContent":["/**\n * The replication handler needs to know\n * which local documents have been lastly written locally\n * and which came from the remote.\n * To determine this, we 'flag' the document\n * by setting a specially crafted revision string.\n */\n\nimport {\n    hash\n} from '../../util';\n\n\n/**\n * Returns a new revision key without the revision height.\n * The revision is crafted for the graphql replication\n * and contains the information that this document data was pulled\n * from the remote server and not saved by the client.\n */\nexport function createRevisionForPulledDocument(\n    replicationIdentifierHash: string,\n    doc: any\n) {\n    const dataHash = hash(doc);\n\n    const ret =\n        dataHash.substring(0, 8) +\n        replicationIdentifierHash.substring(0, 30);\n    return ret;\n}\n\nexport function wasRevisionfromPullReplication(\n    replicationIdentifierHash: string,\n    revision: string\n) {\n    const useFromHash = replicationIdentifierHash.substring(0, 30)\n\n    const ret = revision.endsWith(useFromHash);\n    return ret;\n}\n"],"file":"revision-flag.js"}