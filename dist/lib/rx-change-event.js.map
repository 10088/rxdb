{"version":3,"sources":["../../src/rx-change-event.ts"],"names":["getDocumentDataOfRxChangeEvent","rxChangeEvent","documentData","previousDocumentData","isRxChangeEventIntern","collectionName","charAt","rxChangeEventToEventReduceChangeEvent","operation","id","documentId","doc","previous","overwritable","deepFreezeWhenDevMode"],"mappings":";;;;;;;;;AAQA;;AARA;AACA;AACA;AACA;AAgBO,SAASA,8BAAT,CACHC,aADG,EAEF;AACD,MAAKA,aAAD,CAAuBC,YAA3B,EAAyC;AACrC,WAAQD,aAAD,CAAuBC,YAA9B;AACH,GAFD,MAEO;AACH,WAAQD,aAAD,CAAuBE,oBAA9B;AACH;AAEJ;;AAEM,SAASC,qBAAT,CACHH,aADG,EAEI;AACP,MAAIA,aAAa,CAACI,cAAd,IAAgCJ,aAAa,CAACI,cAAd,CAA6BC,MAA7B,CAAoC,CAApC,MAA2C,GAA/E,EAAoF;AAChF,WAAO,IAAP;AACH,GAFD,MAEO;AACH,WAAO,KAAP;AACH;AACJ;;AAGM,SAASC,qCAAT,CACHN,aADG,EAE4B;AAC/B,UAAQA,aAAa,CAACO,SAAtB;AACI,SAAK,QAAL;AACI,aAAO;AACHA,QAAAA,SAAS,EAAEP,aAAa,CAACO,SADtB;AAEHC,QAAAA,EAAE,EAAER,aAAa,CAACS,UAFf;AAGHC,QAAAA,GAAG,EAAEV,aAAa,CAACC,YAHhB;AAIHU,QAAAA,QAAQ,EAAE;AAJP,OAAP;;AAMJ,SAAK,QAAL;AACI,aAAO;AACHJ,QAAAA,SAAS,EAAEP,aAAa,CAACO,SADtB;AAEHC,QAAAA,EAAE,EAAER,aAAa,CAACS,UAFf;AAGHC,QAAAA,GAAG,EAAEE,2BAAaC,qBAAb,CAAmCb,aAAa,CAACC,YAAjD,CAHF;AAIHU,QAAAA,QAAQ,EAAEX,aAAa,CAACE,oBAAd,GAAqCF,aAAa,CAACE,oBAAnD,GAAiF;AAJxF,OAAP;;AAMJ,SAAK,QAAL;AACI,aAAO;AACHK,QAAAA,SAAS,EAAEP,aAAa,CAACO,SADtB;AAEHC,QAAAA,EAAE,EAAER,aAAa,CAACS,UAFf;AAGHC,QAAAA,GAAG,EAAE,IAHF;AAIHC,QAAAA,QAAQ,EAAEX,aAAa,CAACE;AAJrB,OAAP;AAhBR;AAuBH","sourcesContent":["/**\n * RxChangeEvents a emitted when something in the database changes\n * they can be grabbed by the observables of database, collection and document\n */\n\nimport {\n    ChangeEvent as EventReduceChangeEvent,\n} from 'event-reduce-js';\nimport { overwritable } from './overwritable';\n\nimport type {\n    RxChangeEvent\n} from './types';\n\nexport type RxChangeEventBroadcastChannelData = {\n    cE: RxChangeEvent<any>,\n    storageToken: string\n};\n\nexport function getDocumentDataOfRxChangeEvent<T>(\n    rxChangeEvent: RxChangeEvent<T>\n): T {\n    if ((rxChangeEvent as any).documentData) {\n        return (rxChangeEvent as any).documentData;\n    } else {\n        return (rxChangeEvent as any).previousDocumentData;\n    }\n\n}\n\nexport function isRxChangeEventIntern(\n    rxChangeEvent: RxChangeEvent<any>\n): boolean {\n    if (rxChangeEvent.collectionName && rxChangeEvent.collectionName.charAt(0) === '_') {\n        return true;\n    } else {\n        return false;\n    }\n}\n\n\nexport function rxChangeEventToEventReduceChangeEvent<DocType>(\n    rxChangeEvent: RxChangeEvent<DocType>\n): EventReduceChangeEvent<DocType> {\n    switch (rxChangeEvent.operation) {\n        case 'INSERT':\n            return {\n                operation: rxChangeEvent.operation,\n                id: rxChangeEvent.documentId,\n                doc: rxChangeEvent.documentData as any,\n                previous: null\n            };\n        case 'UPDATE':\n            return {\n                operation: rxChangeEvent.operation,\n                id: rxChangeEvent.documentId,\n                doc: overwritable.deepFreezeWhenDevMode(rxChangeEvent.documentData) as any,\n                previous: rxChangeEvent.previousDocumentData ? rxChangeEvent.previousDocumentData as any : 'UNKNOWN'\n            };\n        case 'DELETE':\n            return {\n                operation: rxChangeEvent.operation,\n                id: rxChangeEvent.documentId,\n                doc: null,\n                previous: rxChangeEvent.previousDocumentData as DocType\n            };\n    }\n}\n"],"file":"rx-change-event.js"}